<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>🏆 LOL Impostor - League of Legends</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="/socket.io/socket.io.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- Pantalla de Lobby -->
  <div id="lobby-screen" class="screen">
    <div class="lol-background"></div>
  <div class="container">
      <div class="row justify-content-center align-items-center min-vh-100">
        <div class="col-lg-8 col-md-10">
          <div class="lol-card lol-card-main text-center">
            <div class="lol-logo mb-4">
              <h1 class="game-title">
                <i class="fas fa-mask"></i>
                EL IMPOSTOR
                <i class="fas fa-mask"></i>
              </h1>
              <p class="game-subtitle">League of Legends Edition</p>
            </div>
             <!-- Pantalla de Lobby -->
            <div class="lobby-content">
              <div class="row">
                <div id="lobby-form" class="col-lg-8 mx-auto">
                  <div class="join-form mb-4">
                    <h3 class="mb-3"><i class="fas fa-user"></i> Unirse al Juego</h3>
                    <div class="input-group mb-3">
                      <span class="input-group-text"><i class="fas fa-user"></i></span>
                      <input id="playerName" class="form-control lol-input" placeholder="Tu nombre de invocador" maxlength="20" />
                    </div>
                    <div class="input-group mb-3">
                      <span class="input-group-text"><i class="fas fa-key"></i></span>
                      <input id="roomCode" class="form-control lol-input" placeholder="Código de sala" maxlength="10" />
                    </div>
                    <button class="btn btn-lol btn-primary me-2" onclick="joinRoom()">
                      <i class="fas fa-sign-in-alt"></i> Entrar a la Sala
                    </button>
                    <button class="btn btn-lol btn-success" onclick="createRoom()">
                      <i class="fas fa-plus"></i> Crear Sala
                    </button>
                  </div>
                </div>

                <!-- Nueva sección para explorar salas -->
                <div id="explore-rooms-section" class="col-12 mb-4">
                  <div class="explore-rooms-section">
                    <h3 class="mb-3">
                      <i class="fas fa-search"></i> Explorar Salas Públicas
                      <button class="btn btn-lol btn-sm btn-secondary ms-2" onclick="refreshRoomList()">
                        <i class="fas fa-sync"></i> Actualizar
                      </button>
                    </h3>
                    
                    <div id="rooms-list" class="rooms-list">
                      <div class="loading-rooms">
                        <i class="fas fa-spinner fa-spin"></i> Cargando salas...
                      </div>
                    </div>
                    
                    <div class="text-center mt-3">
                      <button class="btn btn-lol btn-success" onclick="showCreateCustomRoomModal()">
                        <i class="fas fa-plus-circle"></i> Crear Sala Personalizada
                      </button>
                    </div>
                  </div>
                </div>

                <div id="sala-lobby" class="col-md-12" style="display: none">
                  <div id="codigo-sala">
                    <h3 class="mb-3">
                      <i class="fas fa-clipboard"></i> Código de sala: 
                      <span id="codigo-sala-text"></span>
                    </h3>
                  </div>                  
                  <div class="players-section">
                    <h4><i class="fas fa-users"></i> Jugadores (<span id="player-count">0</span>/5)</h4>
                    <div id="players-list" class="players-grid mb-3">
                      <div class="empty-slot">Esperando jugador...</div>
                      <div class="empty-slot">Esperando jugador...</div>
                      <div class="empty-slot">Esperando jugador...</div>
                      <div class="empty-slot">Esperando jugador...</div>
                      <div class="empty-slot">Esperando jugador...</div>
                    </div>
                    
                    <!-- Scoreboard -->
                    <div id="lobby-scoreboard" class="scoreboard mb-3" style="display: none;">
                      <h5><i class="fas fa-trophy"></i> Puntuaciones</h5>
                      <div id="lobby-scores-list" class="scores-list">
                        <!-- Se llenará dinámicamente -->
                      </div>
                    </div>
                    <div>
                      <button id="start-game-btn" style="display: inline-block !important;" class="btn btn-lol btn-warning" onclick="startGame()" disabled>
                        <i class="fas fa-play"></i> Iniciar Juego
                      </button>
                      <button id="leave-room-btn" style="display: none" class="btn btn-lol btn-danger" onclick="leaveRoom()">
                        <i class="fas fa-walking"></i> Abadonar sala
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Reglas -->
              <div class="game-rules mt-4">
                <h4><i class="fas fa-info-circle"></i> Reglas del Juego</h4>
                <div class="row">
                  <div class="col-md-4">
                    <div class="rule-item">
                      <i class="fas fa-mask text-danger"></i>
                      <p><strong>Impostor:</strong> No conoce el campeón</p>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="rule-item">
                      <i class="fas fa-search text-primary"></i>
                      <p><strong>Investigadores:</strong> Conocen el campeón</p>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="rule-item">
                      <i class="fas fa-clock text-warning"></i>
                      <p><strong>Turnos:</strong> 20 segundos por palabra</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Pantalla de Juego -->
  <div id="game-screen" class="screen" style="display: none;">
    <div class="lol-background-game"></div>
    
    <!-- Header del juego -->
    <div class="game-header">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-3">
            <div class="room-info">
              <span class="room-code">Sala: <span id="current-room-code"></span></span>
            </div>
          </div>
          <div class="col-md-6 text-center">
            <div class="game-status">
              <h2 id="game-phase" class="phase-title">Fase del Juego</h2>
              <div id="timer-container" class="timer-container">
                <div class="timer-circle">
                  <span id="timer-text">00</span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 text-end">
            <div class="game-controls">
              <div class="round-info">
                <span>Ronda: <span id="current-round">1</span></span>
              </div>
              <button id="back-to-lobby-btn" class="btn btn-lol btn-secondary btn-sm" onclick="goBackToLobby()" title="Volver al Lobby">
                <i class="fas fa-home"></i> Lobby
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid game-container">
      <div class="row">
        <!-- Panel izquierdo - Info del jugador y jugadores -->
        <div class="col-lg-3">
          <div class="game-panel">
            <!-- Información del jugador -->
            <div class="player-info-card mb-3">
              <h5><i class="fas fa-user-secret"></i> Tu Rol</h5>
              <div id="player-role" class="role-display">
                <div class="role-icon"></div>
                <div class="role-text">Esperando...</div>
              </div>
            </div>

            <!-- Lista de jugadores -->
            <div class="players-panel">
              <h5><i class="fas fa-users"></i> Jugadores Vivos</h5>
              <div id="game-players-list" class="game-players-list">
                <!-- Se llenará dinámicamente -->
              </div>
            </div>
            
            <!-- Scoreboard en juego -->
            <div class="scoreboard">
              <h5><i class="fas fa-trophy"></i> Puntuaciones</h5>
              <div id="game-scores-list" class="scores-list">
                <!-- Se llenará dinámicamente -->
              </div>
            </div>
          </div>
        </div>

        <!-- Panel central - Chat y acciones -->
        <div class="col-lg-6">
          <div class="game-panel">
            <!-- Chat -->
            <div class="chat-section">
              <h5><i class="fas fa-comments"></i> Chat del Juego</h5>
              <div id="chat-messages" class="chat-messages">
                <!-- Mensajes del chat -->
              </div>
              
              <!-- Input de chat -->
              <div class="chat-input-section">
                <div id="description-input" class="description-input" style="display: none;">
                  <h6>Es tu turno para describir:</h6>
                  <div class="input-group">
                    <input id="word-input" class="form-control" placeholder="Escribe una palabra para describir el campeón..." maxlength="50">
                    <button class="btn btn-primary" onclick="submitDescription()">
                      <i class="fas fa-paper-plane"></i> Enviar
                    </button>
                  </div>
                </div>

                <div class="input-group chat-input-group">
                  <input id="chat-input" class="form-control" placeholder="Escribe un mensaje..." maxlength="200">
                  <button class="btn btn-secondary" onclick="sendMessage()">
                    <i class="fas fa-paper-plane"></i>
                  </button>
          </div>
        </div>
      </div>
    </div>
  </div>

        <!-- Panel derecho - Votación y información -->
        <div class="col-lg-3">
          <div class="game-panel">
            <!-- Información actual -->
            <div class="current-info mb-3">
              <div id="current-player-turn" class="current-turn" style="display: none;">
                <h6><i class="fas fa-hourglass-half"></i> Turno Actual</h6>
                <div class="current-player">
                  <span id="current-player-name">Jugador</span>
                </div>
              </div>
            </div>

            <!-- Votación -->
            <div id="voting-section" class="voting-section" style="display: none;">
              <h5><i class="fas fa-vote-yea"></i> Votación</h5>
              <p class="text-center mb-3">¿Quién es el impostor?</p>
              <div id="voting-buttons" class="voting-buttons">
                <!-- Se llenará dinámicamente -->
              </div>
              <div id="vote-status" class="vote-status mt-3">
                <small>Esperando votos...</small>
              </div>
            </div>

            <!-- Resultados -->
            <div id="results-section" class="results-section" style="display: none;">
              <h5><i class="fas fa-trophy"></i> Resultado</h5>
              <div id="result-content" class="result-content">
                <!-- Se llenará dinámicamente -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modales y alertas -->
  <div id="error-alert" class="alert alert-danger alert-floating" style="display: none;">
    <i class="fas fa-exclamation-triangle"></i>
    <span id="error-message"></span>
  </div>

  <div id="success-alert" class="alert alert-success alert-floating" style="display: none;">
    <i class="fas fa-check-circle"></i>
    <span id="success-message"></span>
  </div>

  <!-- Modal para crear sala personalizada -->
  <div id="create-room-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content lol-card">
      <div class="modal-header">
        <h4><i class="fas fa-plus-circle"></i> Crear Sala Personalizada</h4>
        <button class="btn btn-sm btn-secondary" onclick="closeCreateRoomModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <div class="mb-3">
          <label for="custom-room-name" class="form-label">Nombre de la Sala</label>
          <input id="custom-room-name" class="form-control lol-input" 
                 placeholder="Ej: Sala Pro, Principiantes, etc." 
                 maxlength="50" />
        </div>
        
        <div class="mb-3">
          <label for="max-players" class="form-label">Máximo de Jugadores</label>
          <select id="max-players" class="form-select lol-input" onchange="updateImpostorOptions()">
            <option value="3">3 jugadores</option>
            <option value="4">4 jugadores</option>
            <option value="5">5 jugadores</option>
            <option value="6" selected>6 jugadores</option>
            <option value="7">7 jugadores</option>
            <option value="8">8 jugadores</option>
          </select>
        </div>
        
        <div class="mb-3">
          <label for="num-impostors" class="form-label">
            Número de Impostores 
            <small class="text-muted">(recomendado automáticamente)</small>
          </label>
          <select id="num-impostors" class="form-select lol-input">
            <option value="1" selected>1 impostor</option>
            <option value="2">2 impostores</option>
          </select>
          <small class="form-text text-muted">
            📊 Más impostores = juego más difícil para investigadores
          </small>
        </div>
        
        <div class="mb-3">
          <label class="form-check-label">
            <input id="is-public" type="checkbox" class="form-check-input" checked>
            Sala pública (aparece en la lista para que otros se unan)
          </label>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-lol btn-secondary me-2" onclick="closeCreateRoomModal()">
          <i class="fas fa-times"></i> Cancelar
        </button>
        <button class="btn btn-lol btn-success" onclick="createCustomRoom()">
          <i class="fas fa-plus"></i> Crear Sala
        </button>
      </div>
    </div>
  </div>

  <!-- Scripts -->

  <script src="js/auxFunctions.js"></script>
  <script src="js/game.js"></script>
</body>
</html>